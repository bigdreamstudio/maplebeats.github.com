<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>
            {% if page.title %}
                {{ page.title}}
            {% else %}
                {{ site.title}}
            {% endif %}
        </title>
        <meta name="author" content="Maplebeats"/>
        {% if page.summary %}
            <meta name="description" content="{{ page.summary}}"/>
        {% endif %}
        <link rel="alternate" href="/atom.xml" title="maplebeats" />
        <link rel="stylesheet" href="/stylesheets/main.css" />
        <link rel="stylesheet" href="/stylesheets/syntax.css" />
        {% for css in page.stylesheet %}
            <link rel="stylesheet" href="{{ css }}" />
        {% endfor %}
    </head>
    <body>
        <!--[if IE]>
        <div class="iexplorer">
            <p>警告！网页不兼容你的浏览器</p>
        </div>
        <![endif]-->
        <header class="head">
            <div class="header">
                <section class="logo">
                    <a href="/"><img src="/images/logo.png" alt="logo" /></a>
                </section>
                <hgroup class="head-title">
                <h1><a rel="nofollow" href="/">AnimeBeats</a></h1>
                <h2>ACG才是我们唯一的归宿！ Σ(っ°д°)っ</h2>
                </hgroup>
                <nav class="nav">
                    <a href="/">Home</a> <a href="/me">Me</a> <a href="/anime">Anime</a> <a href="https://github.com/maplebeats">Res</a> <a href="/atom.xml">Rss</a>
                </nav>
            </div>
        </header><!--header-->
        <div class="head-line"></div>
        <section class="site">
            {{ content }}
        </section>
        <footer>
            <div class="footer">
                <section class="power">
                    <p>Theme by <a href="/me">Maplebeats</a> </p>
                    <p>Powered by <a rel="nofollow" href="https://github.com/mojombo/jekyll">jekyll</a></p>
                </section>
                <section class="link">
                    <ul>
                      <li><a rel="nofollow" href="http://forum.ubuntu.org.cn">ubuntu</a></li>
                      <li><a rel="nofollow" href="http://www.flickr.com/photos/maplebeats/">Flickr</a></li>
                      <li><a href="http://qzworld.net/">Don</a></li>
                      <li><a href="http://www.5dimn.com/">Q.D.</a></li>
                      <li><a href="http://www.cherrot.com/">切萝卜</a></li>
                      <li><a href="http://www.buroniworks.com/">某工房</a></li>
                      <li><a rel="nofollow" href="http://liaochenyuan.sourceforge.net">了尘缘</a></li>
                      <li><a href="http://www.lainme.com">lainme</a></li>
                      <li><a href="http://bancage.qzworld.net/">banban</a></li>
                      <li><a href="http://www.hsyyf.me/">南瓜</a></li>
                      <li><a href="http://gndrive.org/">猎户项圈</a></li>
                  </ul>
                </section>
                <section class="copyleft">
                </section>
                <section class="html5-logo"><img src="/images/html5.png" alt="html5" /></section>
            </div>
        </footer>
        <script src="javascripts/dojo.js"
				data-dojo-config="isDebug: true, async: true">
	    </script>
        {% for js in page.javascript %}
            <script src="{{ js }}"></script>
        {% endfor %}
        {% if page.Isindex %}
        <script>
            require(["dojo/_base/xhr", "dojo/dom", "dojo/on", "dojo/json", "dojo/domReady!"],
                function(xhr, dom, on, json) {
                    var page = {
                        index: 0,
                        Num : 5,
                        MAX : 0,
                        count : 5,
                        next : function () {
                            page.index += 1 ;
                            page.content();
                        },
                        prev : function () {
                            page.index -= 1 ;
                            page.content();
                        },
                        content : function () {
                            window.location="/#"
                            xhr.get({
                                url: "/post.json",
                                handleAs: "json",
                                load: function (data) {
                                    page.MAX = data.length;
                                    if(page.index < 0){
                                        page.index = 0;
                                    }
                                    else if(page.index >= (page.MAX/page.Num|0)){
                                        page.count = page.MAX % page.Num;
                                        page.index = (page.MAX/page.Num|0);
                                    }
                                    else{
                                        page.count = 5;
                                    }
                                    var builder = '';
                                    for (var i = page.index*page.Num ; i < page.index*page.Num + page.count; i++) {
                                            builder += ("<li><h2 class=\"title\"><a href=" + data[i].url + ">" + data[i].title + "</a></h2>");
                                            builder += ("<p>" + data[i].summary + "</p>");
                                    }
                                    dom.byId("posts").innerHTML = builder;
                                },
                                error: function() {
                                    alert("something wrong")
                                }
                            });
                         },
                    }
                on(dom.byId("next"), "click", page.next);
                on(dom.byId("prev"), "click", page.prev);
            });
        </script>
    {% endif %}
    </body>
</html>
